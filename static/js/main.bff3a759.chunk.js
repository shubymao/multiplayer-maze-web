(this["webpackJsonpmultiplayer-maze-web"]=this["webpackJsonpmultiplayer-maze-web"]||[]).push([[0],{27:function(e,t,r){},38:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),a=r(20),c=r.n(a),o=(r(27),r(21)),s=r(2),u=r(7),l=r.n(u),h=r(9),d=r(8),f=r(13),v=r(1),x=function(e){var t=e.onClick,r=e.color,n=e.label;return Object(v.jsx)("button",{className:"p-3 rounded-lg ".concat(r),onClick:t,type:"submit",children:n})},p=i.a.forwardRef((function(e,t){var r=e.size,n=e.onKeyUp,i=e.onKeyDown;return Object(v.jsx)("canvas",{tabIndex:0,onKeyDown:i,onKeyUp:n,ref:t,width:r,height:r,className:"bg-white"})}));p.defaultProps={onKeyDown:function(){return!0},onKeyUp:function(){return!0}};var b,j=p,O=function(e){var t=e.value,r=e.onChange,n=e.label;return Object(v.jsxs)("div",{className:"flex flex-col items-center",children:[Object(v.jsx)("p",{className:"inline-block text-white text-lg",children:n}),Object(v.jsx)("input",{className:"w-16 text-black",value:t,onChange:r})]})},m=[{name:"Home",url:"https://shuby-mao.web.app/"},{name:"Project Page",url:"https://shuby-mao.web.app/projects/web-multiplayer-maze"},{name:"Multiplayer Maze",url:"/online"},{name:"Generator Demo",url:"/generator"},{name:"Offline Maze",url:"/"}],w=function(){var e=m;return Object(v.jsx)("div",{className:"flex justify-items-center flex-wrap gap-4 text-white",children:e.map((function(e){return Object(v.jsx)("a",{href:e.url,className:"hover:text-green-500",children:e.name})}))})},g=r(12),y=r(14);!function(e){e[e.TOP=1]="TOP",e[e.RIGHT=2]="RIGHT",e[e.DOWN=4]="DOWN",e[e.LEFT=8]="LEFT"}(b||(b={}));var T,z,S={r:0,c:0},C=[b.TOP,b.RIGHT,b.DOWN,b.LEFT],M=1e9*Math.random();function P(e){return e===b.TOP?b.DOWN:e===b.RIGHT?b.LEFT:e===b.DOWN?b.TOP:b.RIGHT}function k(e,t){return 0!==(e&t)}function N(e,t){return k(e,t)?e^t:e}function D(e,t,r){var n=t.r,i=t.c;e[n][i]=N(e[n][i],r)}function G(e,t){return new Array(e).fill([]).map((function(){return new Array(e).fill(t)}))}function R(e){M=e||1e9*Math.random()}function I(){if(!M)return Math.random();var e=1e5*Math.sin(M);return M++,e-Math.floor(e)}function E(){var e=[b.TOP,b.RIGHT,b.DOWN,b.LEFT];return function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(I()*(t+1)),n=e[t];e[t]=e[r],e[r]=n}}(e),e}function W(e,t){var r=function(e){return e===b.TOP?[-1,0]:e===b.RIGHT?[0,1]:e===b.DOWN?[1,0]:[0,-1]}(t);if(!r)throw new Error("Delta not found.");return{r:e.r+r[0],c:e.c+r[1]}}function F(e,t){var r=t.r,n=t.c;return r<0||n<0||r>=e.length||n>=e[0].length}function H(e){var t=e.r,r=e.c;return z[t][r]}function L(e){var t=e.r,r=e.c;z[t][r]=!0}function A(e,t){return K.apply(this,arguments)}function K(){return(K=Object(h.a)(l.a.mark((function e(t,r){var n,i,a,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=E(),L(t),!r){e.next=5;break}return e.next=5,r(T,t);case 5:i=Object(g.a)(n),e.prev=6,i.s();case 8:if((a=i.n()).done){e.next=18;break}if(c=a.value,o=W(t,c),F(T,o)||H(o)){e.next=16;break}return D(T,t,c),D(T,o,P(c)),e.next=16,A(o,r);case 16:e.next=8;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[6,20,23,26]])})))).apply(this,arguments)}function U(e){var t=E();L(e);var r,n=Object(g.a)(t);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=W(e,i);F(T,a)||H(a)||(D(T,e,i),D(T,a,P(i)),U(a))}}catch(c){n.e(c)}finally{n.f()}}function X(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(h.a)(l.a.mark((function e(t){var r,n,i,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},n=r.userSeed,i=r.onUpdate,T=G(t,15),z=G(t,!1),R(n),e.next=7,A(S,i);case 7:return e.abrupt("return",T);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return T=G(e,15),z=G(e,!1),R(t),U(S),T}var B=2*Math.PI;function J(e){return new Promise((function(t){return setTimeout(t,e)}))}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=e;return function(){var e=Object(h.a)(l.a.mark((function e(n,i){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.drawGrid(n),r.drawIndicatorSquare(i),e.next=4,J(t);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}var V=function e(t){var r=this;Object(y.a)(this,e),this.ctx=void 0,this.width=void 0,this.height=void 0,this.padX=0,this.padY=0,this.gridSize=-1,this.cellSize=-1,this.playerRadius=-1,this.clearCanvas=function(){r.ctx.clearRect(0,0,r.width,r.height)},this.drawGrid=function(e){if(!e||!function(e){if(!e)return!1;if(0===e.length)return!1;var t=e.length;return-1!==e.reduce((function(e,t){return t&&t.length===e?e:-1}),t)}(e))throw new Error("Grid not valid");r.initDimension(r.width,r.height,e),r.ctx.clearRect(0,0,r.width,r.height),r.drawBoundary();for(var t=0;t<e.length;t++)for(var n=0;n<e[0].length;n++)r.drawCell(e[t][n],{r:t,c:n})},this.drawIndicatorSquare=function(e){r.ctx.beginPath(),r.ctx.fillStyle="#FF0000";var t=e.r,n=e.c;r.ctx.moveTo(r.cCord(n)+1,r.rCord(t)+1),r.ctx.lineTo(r.cCord(n+1)-1,r.rCord(t)+1),r.ctx.lineTo(r.cCord(n+1)-1,r.rCord(t+1)-1),r.ctx.lineTo(r.cCord(n)+1,r.rCord(t+1)-1),r.ctx.closePath(),r.ctx.fill()},this.drawPlayer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#";r.ctx.fillStyle=t,r.ctx.lineWidth=2,r.drawCircle(e,r.playerRadius)},this.initDimension=function(e,t,n){r.gridSize=Math.min(e,t)-20,r.cellSize=r.gridSize/n.length,r.playerRadius=.1*r.cellSize,r.padY=(t-r.gridSize)/2,r.padX=(e-r.gridSize)/2},this.drawCircle=function(e,t){r.ctx.beginPath();var n=r.cCord(e.c),i=r.rCord(e.r);r.ctx.arc(n,i,t,0,B),r.ctx.fill(),r.ctx.stroke()},this.rCord=function(e){return r.padY+e*r.cellSize},this.cCord=function(e){return r.padX+e*r.cellSize},this.drawBoundary=function(){r.gridSize>0&&(r.ctx.lineWidth=1,r.ctx.strokeStyle="#000000",r.ctx.beginPath(),r.ctx.moveTo(r.padX,r.padY),r.ctx.lineTo(r.padX+r.gridSize,r.padY),r.ctx.lineTo(r.padX+r.gridSize,r.padY+r.gridSize),r.ctx.lineTo(r.padX,r.padY+r.gridSize),r.ctx.closePath(),r.ctx.stroke())},this.drawCell=function(e,t){var n,i=Object(g.a)(C);try{for(i.s();!(n=i.n()).done;){var a=n.value;k(e,a)&&r.drawWall(t,a)}}catch(c){i.e(c)}finally{i.f()}},this.drawWall=function(e,t){var n=e.r,i=e.c;r.ctx.beginPath(),t===b.TOP||t===b.LEFT?r.ctx.moveTo(r.cCord(i),r.rCord(n)):r.ctx.moveTo(r.cCord(i+1),r.rCord(n+1)),t===b.TOP||t===b.RIGHT?r.ctx.lineTo(r.cCord(i+1),r.rCord(n)):r.ctx.lineTo(r.cCord(i),r.rCord(n+1)),r.ctx.closePath(),r.ctx.stroke()};var n=function(e){if(!e)throw new Error("Canvas is not defined.");var t=e.height,r=e.width,n=e.getContext("2d");if(!n)throw new Error("Unable to get context.");return{context:n,height:t,width:r}}(t),i=n.context,a=n.height,c=n.width;this.ctx=i,this.width=c,this.height=a};function Z(e,t){return function(r){var n=r.target.value;n&&!t(parseInt(n,10))||e(n)}}var $=function(){var e=Object(n.createRef)(),t=Object(n.useState)("10"),r=Object(d.a)(t,2),i=r[0],a=r[1],c=Object(n.useState)("10"),o=Object(d.a)(c,2),s=o[0],u=o[1],p=Object(n.useState)(Math.floor(1e5*Math.random()).toString()),b=Object(d.a)(p,2),m=b[0],g=b[1],y=Object(n.useState)(!1),T=Object(d.a)(y,2),z=T[0],S=T[1],C=Object(f.useMediaQuery)({query:"(min-width: 550px)"}),M=Object(n.useState)(C?500:250),P=Object(d.a)(M,2),k=P[0],N=P[1];Object(n.useEffect)((function(){N(C?500:200)}),[C]);var D=function(){var t=Object(h.a)(l.a.mark((function t(){var r,n,a,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!z){t.next=2;break}return t.abrupt("return");case 2:return S(!0),r=e.current,n=new V(r),a=Q(n,parseInt(s,10)),c=parseInt(m,10),t.next=9,X(parseInt(i,10),{onUpdate:a,userSeed:c});case 9:o=t.sent,n.drawGrid(o),S(!1);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),G=Z(a,(function(e){return e<=50})),R=Z(u,(function(e){return e<400})),I=Z(g,(function(e){return e<1e5}));return Object(v.jsx)("div",{className:"w-full min-h-screen bg-gray-700",children:Object(v.jsxs)("div",{className:"space-y-3 flex flex-col items-center p-4 text-white",children:[Object(v.jsx)("h1",{className:"text-4xl my-4",children:"Generation Demo"}),Object(v.jsx)(w,{}),Object(v.jsx)(j,{ref:e,size:k}),Object(v.jsxs)("div",{className:"flex flex-wrap gap-3 items-center place-content-center",children:[Object(v.jsx)(O,{label:"Size",value:i,onChange:G}),Object(v.jsx)(O,{label:"Delay",value:s,onChange:R}),Object(v.jsx)(O,{label:"Seed",value:m,onChange:I}),Object(v.jsx)(x,{color:"bg-green-500",onClick:D,label:"Generate"})]})]})})},_={r:.5,c:.5},ee=.1,te=.04,re=function e(t,r,n){var i=this;Object(y.a)(this,e),this.canvasManager=void 0,this.level=void 0,this.maze=void 0,this.gridSize=void 0,this.position=void 0,this.seed=void 0,this.setLevel=function(e){i.level=e,i.gridSize+=e+5,i.position=_,i.maze=q(i.gridSize,i.seed),i.renderGame()},this.getMaze=function(){return i.maze},this.getPosition=function(){return i.position},this.performMove=function(e){var t=i.position.r,r=i.position.c;k(e,b.TOP)&&(t-=te),k(e,b.DOWN)&&(t+=te),k(e,b.LEFT)&&(r-=te),k(e,b.RIGHT)&&(r+=te),i.position=i.getBoundedCord(t,r)},this.getBoundedCord=function(e,t){var r=i.position,n=r.r,a=r.c,c=[Math.floor(n),Math.floor(a)],o=c[0],s=c[1],u=i.maze[o][s];return k(u,b.TOP)&&(e=Math.max(o+ee,e)),k(u,b.DOWN)&&(e=Math.min(o+1-ee,e)),k(u,b.LEFT)&&(t=Math.max(s+ee,t)),k(u,b.RIGHT)&&(t=Math.min(s+1-ee,t)),{r:e,c:t}},this.checkWin=function(){var e=Math.abs(i.position.r-(i.gridSize-.5)),t=Math.abs(i.position.c-(i.gridSize-.5));return e<=.5&&t<=.5},this.renderGame=function(){i.canvasManager.drawGrid(i.maze),i.canvasManager.drawPlayer(i.position)},this.seed=n,this.level=r,this.gridSize=this.level+5,this.position=_,this.maze=q(this.gridSize,this.seed),this.canvasManager=new V(t)},ne={ArrowLeft:b.LEFT,ArrowUp:b.TOP,ArrowRight:b.RIGHT,ArrowDown:b.DOWN};var ie=function(){var e=Object(n.useState)(1),t=Object(d.a)(e,2),r=t[0],a=t[1],c=Object(n.useRef)(null),o=Object(f.useMediaQuery)({query:"(min-width: 550px)"}),s=Object(n.useState)(o?500:250),u=Object(d.a)(s,2),l=u[0],h=u[1],x=Object(n.useRef)(),p=i.a.useRef(0),b=0;Object(n.useEffect)((function(){h(o?500:200),x.current=new re(c.current,r)}),[o,r]);var O=Object(n.useCallback)((function(){var e,t,n;null===(e=x.current)||void 0===e||e.performMove(b),null===(t=x.current)||void 0===t||t.renderGame(),(null===(n=x.current)||void 0===n?void 0:n.checkWin())&&a(r+1),p.current=requestAnimationFrame(O)}),[b,x,r]);return i.a.useEffect((function(){return requestAnimationFrame(O),function(){return cancelAnimationFrame(p.current)}}),[O]),Object(v.jsx)("div",{className:"w-full min-h-screen bg-gray-700",children:Object(v.jsxs)("div",{className:"space-y-3 flex flex-col items-center p-4 text-white",children:[Object(v.jsxs)("h1",{className:"text-4xl my-4",children:["Offline Maze Level ",r]}),Object(v.jsx)(w,{}),Object(v.jsx)(j,{onKeyDown:function(e){e.preventDefault();var t=ne[e.key]||0;b=function(e,t){return e|t}(b,t)},onKeyUp:function(e){var t=ne[e.key]||0;e.preventDefault(),b=N(b,t)},ref:c,size:l})]})})};var ae=function(){return Object(v.jsxs)("div",{className:"w-full h-screen flex flex-col space-y-3 text-center items-center",children:[Object(v.jsx)("h1",{children:"Maze Multiplayer"}),Object(v.jsx)(w,{})]})};var ce=function(){return Object(v.jsx)(o.a,{children:Object(v.jsxs)(s.c,{children:[Object(v.jsx)(s.a,{path:"/online",children:Object(v.jsx)(ae,{})}),Object(v.jsx)(s.a,{path:"/generator",children:Object(v.jsx)($,{})}),Object(v.jsx)(s.a,{path:"/",children:Object(v.jsx)(ie,{})})]})})};c.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(ce,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.bff3a759.chunk.js.map